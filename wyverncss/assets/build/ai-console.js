(()=>{"use strict";var e={n:s=>{var n=s&&s.__esModule?()=>s.default:()=>s;return e.d(n,{a:n}),n},d:(s,n)=>{for(var a in n)e.o(n,a)&&!e.o(s,a)&&Object.defineProperty(s,a,{enumerable:!0,get:n[a]})},o:(e,s)=>Object.prototype.hasOwnProperty.call(e,s)};const s=window.wp.element,n=window.React,a=window.wp.i18n,i=window.wp.components;async function t(e,s={}){const n=function(){if(void 0===window.wyvernPressAI)throw new Error("WordPress data not found. Ensure the script is properly enqueued.");return window.wyvernPressAI}(),a=`${n.apiUrl}${e}`;try{const e=await fetch(a,{...s,headers:{"Content-Type":"application/json","X-WP-Nonce":n.nonce,...s.headers}}),i=await e.json();return e.ok?{success:!0,data:i}:{success:!1,error:i}}catch(e){return{success:!1,error:{code:"network_error",message:e instanceof Error?e.message:"Network request failed"}}}}const r={sendMessage:async e=>t("/chat/message",{method:"POST",body:JSON.stringify(e)}),getConversations:async(e=20,s=0,n="desc")=>t(`/chat/conversations?${new URLSearchParams({limit:e.toString(),offset:s.toString(),order:n})}`),createConversation:async e=>t("/chat/conversations",{method:"POST",body:JSON.stringify(e)}),getConversation:async(e,s=50)=>t(`/chat/conversations/${e}?${new URLSearchParams({limit:s.toString()})}`),deleteConversation:async e=>t(`/chat/conversations/${e}`,{method:"DELETE"}),async getHistory(e,s=50,n){const a=new URLSearchParams({limit:s.toString()});return n&&a.append("before",n.toString()),t(`/chat/history/${e}?${a}`)}},l=async()=>t("/settings"),o=async e=>t("/settings/openrouter-key",{method:"POST",body:JSON.stringify({api_key:e})}),c=async()=>t("/settings/openrouter-key",{method:"DELETE"}),d=async e=>t("/settings/verify-key",{method:"POST",body:JSON.stringify({api_key:e})}),m=async e=>t("/settings/preferences",{method:"POST",body:JSON.stringify(e)}),u=async()=>t("/settings/models"),y=async e=>t("/admin-ai/execute",{method:"POST",body:JSON.stringify(e)});function h(){const[e,n]=(0,s.useState)(null),[a,i]=(0,s.useState)([]),[t,r]=(0,s.useState)(!1),[y,h]=(0,s.useState)(null),g=(0,s.useCallback)(async()=>{r(!0),h(null);try{const e=await l();e.success&&e.data?n(e.data):h(e.error?.message||"Failed to load settings")}catch(e){h(e instanceof Error?e.message:"Unknown error")}finally{r(!1)}},[]),v=(0,s.useCallback)(async()=>{r(!0),h(null);try{const e=await u();e.success&&e.data?i(e.data.models):h(e.error?.message||"Failed to load models")}catch(e){h(e instanceof Error?e.message:"Unknown error")}finally{r(!1)}},[]),_=(0,s.useCallback)(async e=>{r(!0),h(null);try{const s=await o(e);return s.success?(await g(),!0):(h(s.error?.message||"Failed to save API key"),!1)}catch(e){return h(e instanceof Error?e.message:"Unknown error"),!1}finally{r(!1)}},[g]),x=(0,s.useCallback)(async e=>{r(!0),h(null);try{const s=await d(e);return!(!s.success||!s.data?.valid)||(h(s.data?.message||"API key verification failed"),!1)}catch(e){return h(e instanceof Error?e.message:"Unknown error"),!1}finally{r(!1)}},[]),j=(0,s.useCallback)(async()=>{r(!0),h(null);try{const e=await c();return e.success?(await g(),!0):(h(e.error?.message||"Failed to delete API key"),!1)}catch(e){return h(e instanceof Error?e.message:"Unknown error"),!1}finally{r(!1)}},[g]),p=(0,s.useCallback)(async e=>{r(!0),h(null);try{const s=await m(e);return s.success?(await g(),!0):(h(s.error?.message||"Failed to save preferences"),!1)}catch(e){return h(e instanceof Error?e.message:"Unknown error"),!1}finally{r(!1)}},[g]);return(0,s.useEffect)(()=>{g()},[g]),{settings:e,models:a,isLoading:t,error:y,hasApiKey:e?.has_api_key||!1,saveApiKey:_,verifyApiKey:x,deleteApiKey:j,savePreferences:p,loadSettings:g,loadModels:v}}function g(){const[e,n]=(0,s.useState)([]),[a,i]=(0,s.useState)(null),[t,l]=(0,s.useState)(!1),[o,c]=(0,s.useState)(null),d=(0,s.useCallback)(async()=>{l(!0),c(null);try{const e=await r.getConversations(50,0,"desc");e.success&&e.data?(n(e.data.conversations),!a&&e.data.conversations.length>0&&i(e.data.conversations[0].id)):c(e.error?.message||"Failed to load conversations")}catch(e){c(e instanceof Error?e.message:"Unknown error")}finally{l(!1)}},[a]),m=(0,s.useCallback)(async e=>{l(!0),c(null);try{const s=await r.createConversation(e);return s.success&&s.data?(await d(),i(s.data.id),s.data.id):(c(s.error?.message||"Failed to create conversation"),null)}catch(e){return c(e instanceof Error?e.message:"Unknown error"),null}finally{l(!1)}},[d]),u=(0,s.useCallback)(async s=>{l(!0),c(null);try{const n=await r.deleteConversation(s);if(n.success){if(a===s){const n=e.filter(e=>e.id!==s);i(n.length>0?n[0].id:null)}return await d(),!0}return c(n.error?.message||"Failed to delete conversation"),!1}catch(e){return c(e instanceof Error?e.message:"Unknown error"),!1}finally{l(!1)}},[a,e,d]),y=(0,s.useCallback)(e=>{i(e)},[]),h=(0,s.useCallback)(async()=>{if(a){l(!0),c(null);try{const e=await r.getConversation(a);e.success&&e.data?n(s=>s.map(s=>s.id===a?{...s,updated_at:e.data.updated_at}:s)):c(e.error?.message||"Failed to refresh conversation")}catch(e){c(e instanceof Error?e.message:"Unknown error")}finally{l(!1)}}},[a]);return(0,s.useEffect)(()=>{d()},[d]),{conversations:e,currentConversationId:a,isLoading:t,error:o,createConversation:m,deleteConversation:u,selectConversation:y,loadConversations:d,refreshCurrent:h}}const v=window.ReactJSXRuntime;function _({toolCall:e,showDetails:s=!0}){const{tool:n,arguments:i,result:t,success:r,execution_time_ms:l,error:o}=e;return(0,v.jsxs)("div",{className:"tool-execution "+(r?"tool-success":"tool-error"),role:"region","aria-label":(0,a.__)("Tool execution result","wyvern-ai-styling"),children:[(0,v.jsxs)("div",{className:"tool-header",children:[(0,v.jsx)("span",{className:"tool-icon","aria-hidden":"true",children:r?"âœ“":"âœ—"}),(0,v.jsx)("span",{className:"tool-name",children:n}),(0,v.jsxs)("span",{className:"tool-time",children:[l,"ms"]})]}),s&&(0,v.jsxs)(v.Fragment,{children:[Object.keys(i).length>0&&(0,v.jsxs)("details",{className:"tool-details",children:[(0,v.jsx)("summary",{children:(0,a.__)("Arguments","wyvern-ai-styling")}),(0,v.jsx)("pre",{children:(0,v.jsx)("code",{children:JSON.stringify(i,null,2)})})]}),t&&(0,v.jsxs)("details",{className:"tool-details",children:[(0,v.jsx)("summary",{children:(0,a.__)("Result","wyvern-ai-styling")}),(0,v.jsx)("pre",{children:(0,v.jsx)("code",{children:JSON.stringify(t,null,2)})})]}),o&&(0,v.jsxs)("div",{className:"tool-error-message",role:"alert",children:[(0,v.jsx)("strong",{children:(0,a.__)("Error:","wyvern-ai-styling")})," ",o]})]})]})}function x(e){try{return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return""}}function j({message:e,showToolExecutions:s=!0}){const{role:n,content:i,tool_calls:t,tokens_used:r,cost_usd:l,created_at:o}=e;return(0,v.jsxs)("div",{className:`message-bubble message-${n}`,role:"article","aria-label":`${n} message`,children:[(0,v.jsxs)("div",{className:"message-header",children:[(0,v.jsx)("span",{className:"message-role",children:"user"===n?(0,a.__)("You","wyvern-ai-styling"):(0,a.__)("AI Assistant","wyvern-ai-styling")}),(0,v.jsx)("span",{className:"message-time",children:x(o)})]}),(0,v.jsx)("div",{className:"message-content",children:(0,v.jsx)("p",{children:i})}),s&&t&&t.length>0&&(0,v.jsxs)("div",{className:"message-tools",children:[(0,v.jsx)("div",{className:"tools-header",children:(0,a.__)("Actions Performed:","wyvern-ai-styling")}),t.map((e,s)=>(0,v.jsx)(_,{toolCall:e,showDetails:!0},`${e.tool}-${s}`))]}),"assistant"===n&&(r||void 0!==l)&&(0,v.jsxs)("div",{className:"message-meta",children:[r&&(0,v.jsxs)("span",{className:"meta-tokens",children:[r," ",(0,a.__)("tokens","wyvern-ai-styling")]}),void 0!==l&&(0,v.jsxs)("span",{className:"meta-cost",children:["$",l.toFixed(4)]})]})]})}function p({messages:e,isLoading:n=!1,showToolExecutions:i=!0}){const t=(0,s.useRef)(null);return(0,s.useEffect)(()=>{t.current?.scrollIntoView({behavior:"smooth"})},[e]),0!==e.length||n?(0,v.jsxs)("div",{className:"message-list",role:"log","aria-label":(0,a.__)("Chat messages","wyvern-ai-styling"),"aria-live":"polite",children:[e.map(e=>(0,v.jsx)(j,{message:e,showToolExecutions:i},e.id)),n&&(0,v.jsxs)("div",{className:"message-bubble message-loading",role:"status",children:[(0,v.jsxs)("div",{className:"loading-indicator",children:[(0,v.jsx)("span",{className:"loading-dot"}),(0,v.jsx)("span",{className:"loading-dot"}),(0,v.jsx)("span",{className:"loading-dot"})]}),(0,v.jsx)("span",{className:"sr-only",children:(0,a.__)("AI is thinkingâ€¦","wyvern-ai-styling")})]}),(0,v.jsx)("div",{ref:t})]}):(0,v.jsx)("div",{className:"message-list-empty",role:"status",children:(0,v.jsxs)("div",{className:"empty-state",children:[(0,v.jsx)("div",{className:"empty-icon","aria-hidden":"true",children:"ðŸ’¬"}),(0,v.jsx)("h3",{children:(0,a.__)("Start a Conversation","wyvern-ai-styling")}),(0,v.jsx)("p",{children:(0,a.__)("Ask me anything about your WordPress site. I can help you create content, manage posts, configure settings, and more!","wyvern-ai-styling")})]})})}function w({onSend:e,disabled:n=!1,placeholder:t=(0,a.__)("Ask me anything about your WordPress siteâ€¦","wyvern-ai-styling")}){const[r,l]=(0,s.useState)(""),o=(0,s.useRef)(null),c=()=>{const s=r.trim();s&&!n&&(e(s),l(""),o.current?.focus())};return(0,v.jsxs)("div",{className:"message-input-container",children:[(0,v.jsxs)("div",{className:"message-input-wrapper",children:[(0,v.jsx)("textarea",{ref:o,className:"message-input",value:r,onChange:e=>{const s=e.target;l(s.value),s.style.height="auto",s.style.height=`${Math.min(s.scrollHeight,200)}px`},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),c())},placeholder:t,disabled:n,rows:1,"aria-label":(0,a.__)("Message input","wyvern-ai-styling"),"aria-describedby":"message-input-help"}),(0,v.jsx)(i.Button,{variant:"primary",className:"message-send-button",onClick:c,disabled:n||!r.trim(),"aria-label":(0,a.__)("Send message","wyvern-ai-styling"),children:(0,a.__)("Send","wyvern-ai-styling")})]}),(0,v.jsx)("div",{id:"message-input-help",className:"message-input-help",children:(0,a.__)("Press Enter to send, Shift+Enter for new line","wyvern-ai-styling")})]})}function f({conversationId:e,showToolExecutions:n=!0}){const{messages:t,isLoading:l,isSending:o,error:c,sendMessage:d}=function(e){const[n,i]=(0,s.useState)([]),[t,l]=(0,s.useState)(!1),[o,c]=(0,s.useState)(!1),[d,m]=(0,s.useState)(null),u=(0,s.useCallback)(async()=>{if(e){l(!0),m(null);try{const s=await r.getHistory(e,100);s.success&&s.data?i(s.data.messages):m(s.error?.message||(0,a.__)("Failed to load message history","wyvern-ai-styling"))}catch(e){m(e instanceof Error?e.message:(0,a.__)("Unknown error","wyvern-ai-styling"))}finally{l(!1)}}else i([])},[e]),y=(0,s.useCallback)(async(s,n)=>{if(!e)return m((0,a.__)("No conversation selected","wyvern-ai-styling")),!1;if(!s.trim())return m((0,a.__)("Message cannot be empty","wyvern-ai-styling")),!1;c(!0),m(null);const t={id:Date.now(),conversation_id:e,role:"user",content:s.trim(),created_at:(new Date).toISOString()};i(e=>[...e,t]);try{const l={conversation_id:e,message:s.trim(),model:n},o=await r.sendMessage(l);if(o.success&&o.data){const s={id:o.data.message_id,conversation_id:e,role:"assistant",content:o.data.message,tool_calls:o.data.tool_calls,tokens_used:o.data.usage.total_tokens,cost_usd:o.data.usage.estimated_cost,created_at:(new Date).toISOString()};return i(e=>[...e.filter(e=>e.id!==t.id),{...t,id:o.data.message_id-1},s]),!0}return i(e=>e.filter(e=>e.id!==t.id)),m(o.error?.message||(0,a.__)("Failed to send message","wyvern-ai-styling")),!1}catch(e){return i(e=>e.filter(e=>e.id!==t.id)),m(e instanceof Error?e.message:(0,a.__)("Unknown error","wyvern-ai-styling")),!1}finally{c(!1)}},[e]),h=(0,s.useCallback)(()=>{i([])},[]);return(0,s.useEffect)(()=>{u()},[e,u]),{messages:n,isLoading:t,isSending:o,error:d,sendMessage:y,loadHistory:u,clearMessages:h}}(e),{createConversation:m}=g(),u=async s=>{if(e)await d(s);else{const e=s.substring(0,50)+(s.length>50?"...":"");if(!await m({title:e}))return;setTimeout(async()=>{await d(s)},100)}};return e?(0,v.jsxs)("div",{className:"chat-interface",children:[c&&(0,v.jsx)(i.Notice,{status:"error",isDismissible:!1,children:c}),(0,v.jsx)(p,{messages:t,isLoading:o,showToolExecutions:n}),(0,v.jsx)(w,{onSend:u,disabled:o||l})]}):(0,v.jsxs)("div",{className:"chat-interface-empty",children:[(0,v.jsxs)("div",{className:"empty-state",children:[(0,v.jsx)("div",{className:"empty-icon","aria-hidden":"true",children:"ðŸ‘‹"}),(0,v.jsx)("h2",{children:(0,a.__)("How can I help you today?","wyvern-ai-styling")}),(0,v.jsx)("p",{children:(0,a.__)("I can help you create and manage WordPress content, answer questions about your site, and more. Just start typing below to begin!","wyvern-ai-styling")})]}),(0,v.jsx)(w,{onSend:u,disabled:o||l,placeholder:(0,a.__)("Ask me anything about WordPressâ€¦","wyvern-ai-styling")})]})}const b=window.wp.apiFetch;var N=e.n(b);function C(){const[e,n]=(0,s.useState)({status:"checking",toolsCount:0,tools:[]});return(0,s.useEffect)(()=>{const e=async()=>{try{const e=await N()({path:"/wyvernpress/v1/mcp/status",method:"GET"});n({status:e.status,source:e.source,toolsCount:e.tools_count,tools:e.tools,message:e.message})}catch(e){n({status:"offline",toolsCount:0,tools:[],error:e instanceof Error?e.message:(0,a.__)("Failed to check MCP server status","wyvern-ai-styling")})}};e();const s=setInterval(e,3e4);return()=>clearInterval(s)},[]),(0,v.jsx)(i.Panel,{children:(0,v.jsx)(i.PanelBody,{title:(0,a.__)("MCP Server Status","wyvern-ai-styling"),initialOpen:!0,children:(0,v.jsx)(i.PanelRow,{children:(0,v.jsxs)("div",{className:"mcp-status-container",children:[(0,v.jsxs)("div",{className:"mcp-status-header",children:[(0,v.jsxs)("div",{className:"mcp-status-indicator",children:["checking"===e.status&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(i.Spinner,{}),(0,v.jsx)("span",{children:(0,a.__)("Checkingâ€¦","wyvern-ai-styling")})]}),"online"===e.status&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{className:"status-dot status-online","aria-hidden":"true",children:"â—"}),(0,v.jsx)("strong",{style:{color:"#00a32a"},children:(0,a.__)("Online","wyvern-ai-styling")})]}),"offline"===e.status&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{className:"status-dot status-offline","aria-hidden":"true",children:"â—"}),(0,v.jsx)("strong",{style:{color:"#cc1818"},children:(0,a.__)("Offline","wyvern-ai-styling")})]})]}),e.source&&(0,v.jsx)("div",{className:"mcp-source",style:{marginTop:"4px"},children:(0,v.jsxs)("small",{style:{color:"#757575"},children:[(0,a.__)("Source:","wyvern-ai-styling")," ",e.source," (",e.toolsCount," ",1===e.toolsCount?(0,a.__)("tool","wyvern-ai-styling"):(0,a.__)("tools","wyvern-ai-styling"),")"]})})]}),e.message&&"online"===e.status&&(0,v.jsx)("div",{className:"mcp-message",style:{marginTop:"8px"},children:(0,v.jsx)("small",{style:{color:"#757575"},children:e.message})}),e.error&&(0,v.jsx)("div",{className:"mcp-error",style:{marginTop:"8px",color:"#cc1818"},children:(0,v.jsx)("small",{children:e.error})}),"online"===e.status&&e.tools.length>0&&(0,v.jsxs)("div",{className:"mcp-tools",style:{marginTop:"16px"},children:[(0,v.jsx)("h4",{children:(0,a.__)("Available Tools","wyvern-ai-styling")}),(0,v.jsx)("ul",{className:"mcp-tools-list",style:{marginLeft:0,paddingLeft:0,listStyle:"none"},children:e.tools.map(e=>(0,v.jsx)("li",{className:"mcp-tool-item",style:{padding:"8px 0",borderBottom:"1px solid #ddd"},children:(0,v.jsx)("code",{style:{fontWeight:"bold"},children:e})},e))})]})]})})})})}function k(){const{settings:e,error:n,isLoading:t,hasApiKey:r,saveApiKey:l,verifyApiKey:o,deleteApiKey:c,savePreferences:d}=h(),[m,u]=(0,s.useState)(""),[y,g]=(0,s.useState)(null),[_,x]=(0,s.useState)(null),[j,p]=(0,s.useState)(!1),w=async(s,n)=>{e&&await d({...e.preferences,[s]:n})};return(0,v.jsxs)("div",{className:"settings-panel",children:[(0,v.jsx)("h2",{children:(0,a.__)("WyvernCSS AI Settings","wyvern-ai-styling")}),n&&(0,v.jsx)(i.Notice,{status:"error",isDismissible:!1,children:n}),(0,v.jsx)(C,{}),(0,v.jsxs)(i.Panel,{children:[(0,v.jsxs)(i.PanelBody,{title:(0,a.__)("API Configuration","wyvern-ai-styling"),initialOpen:!0,children:[(0,v.jsxs)("p",{className:"description",children:[(0,a.__)("Enter your OpenRouter API key to enable AI-powered features. Get your key from","wyvern-ai-styling")," ",(0,v.jsx)("a",{href:"https://openrouter.ai/keys",target:"_blank",rel:"noopener noreferrer",children:"openrouter.ai/keys"})]}),y&&(0,v.jsx)(i.Notice,{status:"error",isDismissible:!0,onDismiss:()=>g(null),children:y}),_&&(0,v.jsx)(i.Notice,{status:"success",isDismissible:!0,onDismiss:()=>x(null),children:_}),r?(0,v.jsxs)("div",{className:"api-key-configured",children:[(0,v.jsx)(i.PanelRow,{children:(0,v.jsxs)("div",{className:"api-key-status",children:[(0,v.jsx)("span",{className:"dashicons dashicons-yes-alt",style:{color:"#00a32a"}}),(0,v.jsx)("span",{children:(0,a.__)("API key is configured","wyvern-ai-styling")})]})}),(0,v.jsx)(i.PanelRow,{children:(0,v.jsx)(i.Button,{variant:"secondary",isDestructive:!0,onClick:async()=>{g(null),x(null),await c()?x((0,a.__)("API key removed successfully.","wyvern-ai-styling")):g((0,a.__)("Failed to remove API key.","wyvern-ai-styling"))},disabled:t,children:(0,a.__)("Remove API Key","wyvern-ai-styling")})})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(i.PanelRow,{children:(0,v.jsx)(i.TextControl,{label:(0,a.__)("OpenRouter API Key","wyvern-ai-styling"),value:m,onChange:u,placeholder:"sk-or-v1-...",type:"password",help:(0,a.__)("Your API key is encrypted and stored securely.","wyvern-ai-styling")})}),(0,v.jsx)(i.PanelRow,{children:(0,v.jsx)(i.Button,{variant:"primary",onClick:async()=>{g(null),x(null),p(!0);try{if(!m.startsWith("sk-or-v1-"))return void g((0,a.__)('Invalid API key format. OpenRouter keys start with "sk-or-v1-"',"wyvern-ai-styling"));if(!await o(m))return void g((0,a.__)("API key verification failed. Please check your key.","wyvern-ai-styling"));await l(m)?(x((0,a.__)("API key saved successfully!","wyvern-ai-styling")),u("")):g((0,a.__)("Failed to save API key.","wyvern-ai-styling"))}finally{p(!1)}},disabled:!m||j,children:j?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(i.Spinner,{}),(0,a.__)("Verifyingâ€¦","wyvern-ai-styling")]}):(0,a.__)("Save API Key","wyvern-ai-styling")})})]})]}),e&&(0,v.jsxs)(i.PanelBody,{title:(0,a.__)("Preferences","wyvern-ai-styling"),initialOpen:!1,children:[(0,v.jsx)(i.PanelRow,{children:(0,v.jsx)(i.ToggleControl,{label:(0,a.__)("Show Tool Executions","wyvern-ai-styling"),checked:e.preferences.show_tool_executions,onChange:e=>w("show_tool_executions",e),help:(0,a.__)("Display detailed information about AI actions","wyvern-ai-styling")})}),(0,v.jsx)(i.PanelRow,{children:(0,v.jsx)(i.ToggleControl,{label:(0,a.__)("Auto-save Conversations","wyvern-ai-styling"),checked:e.preferences.auto_save_conversations,onChange:e=>w("auto_save_conversations",e),help:(0,a.__)("Automatically save conversation history","wyvern-ai-styling")})}),(0,v.jsx)(i.PanelRow,{children:(0,v.jsx)(i.TextControl,{label:(0,a.__)("Max Context Messages","wyvern-ai-styling"),type:"number",value:(e.preferences.max_context_messages||20).toString(),onChange:e=>w("max_context_messages",parseInt(e,10)),min:5,max:50,help:(0,a.__)("Number of recent messages to include in AI context","wyvern-ai-styling")})})]}),e?.usage_summary&&(0,v.jsx)(i.PanelBody,{title:(0,a.__)("Usage Summary","wyvern-ai-styling"),initialOpen:!1,children:(0,v.jsx)(i.PanelRow,{children:(0,v.jsxs)("div",{className:"usage-summary",children:[(0,v.jsxs)("div",{className:"usage-stat",children:[(0,v.jsx)("strong",{children:(0,a.__)("Total Conversations:","wyvern-ai-styling")})," ",e.usage_summary.total_conversations]}),(0,v.jsxs)("div",{className:"usage-stat",children:[(0,v.jsx)("strong",{children:(0,a.__)("Total Messages:","wyvern-ai-styling")})," ",e.usage_summary.total_messages]}),(0,v.jsxs)("div",{className:"usage-stat",children:[(0,v.jsx)("strong",{children:(0,a.__)("Cost This Month:","wyvern-ai-styling")})," $",e.usage_summary.total_cost_month.toFixed(2)]}),(0,v.jsxs)("div",{className:"usage-stat",children:[(0,v.jsx)("strong",{children:(0,a.__)("Requests Today:","wyvern-ai-styling")})," ",e.usage_summary.requests_today]})]})})})]})]})}function P(){const[e,s]=(0,n.useState)(null),[t,r]=(0,n.useState)(!0),[l,o]=(0,n.useState)(null),[c,d]=(0,n.useState)(!1),m=async()=>{try{d(!0);const e=await N()({path:"/wyvernpress/v1/debug",method:"GET"});s(e),o(null)}catch(e){o(e instanceof Error?e.message:(0,a.__)("Failed to fetch debug information","wyvern-ai-styling"))}finally{r(!1),d(!1)}};if((0,n.useEffect)(()=>{m()},[]),t)return(0,v.jsxs)("div",{className:"debug-panel-loading",children:[(0,v.jsx)(i.Spinner,{}),(0,v.jsx)("p",{children:(0,a.__)("Loading debug informationâ€¦","wyvern-ai-styling")})]});if(l)return(0,v.jsx)("div",{className:"debug-panel-error",children:(0,v.jsx)(i.Notice,{status:"error",isDismissible:!1,children:l})});if(!e)return null;const u=[{name:"system",title:(0,a.__)("System","wyvern-ai-styling"),className:"debug-tab-system"},{name:"mcp",title:(0,a.__)("MCP Tools","wyvern-ai-styling"),className:"debug-tab-mcp"},{name:"permissions",title:(0,a.__)("Permissions","wyvern-ai-styling"),className:"debug-tab-permissions"},{name:"rest_api",title:(0,a.__)("REST API","wyvern-ai-styling"),className:"debug-tab-rest-api"},{name:"errors",title:(0,a.__)("Errors","wyvern-ai-styling"),className:"debug-tab-errors"},{name:"constants",title:(0,a.__)("Constants","wyvern-ai-styling"),className:"debug-tab-constants"}];return(0,v.jsxs)("div",{className:"debug-panel",children:[(0,v.jsxs)("div",{className:"debug-panel-header",children:[(0,v.jsx)("h2",{children:(0,a.__)("WyvernCSS Debug Information","wyvern-ai-styling")}),(0,v.jsx)("button",{className:"button button-secondary",onClick:m,disabled:c,children:c?(0,a.__)("Refreshingâ€¦","wyvern-ai-styling"):(0,a.__)("Refresh","wyvern-ai-styling")})]}),(0,v.jsx)(i.TabPanel,{className:"debug-tabs",activeClass:"is-active",tabs:u,children:s=>(0,v.jsxs)(v.Fragment,{children:["system"===s.name&&(0,v.jsx)(i.Panel,{children:(0,v.jsx)(i.PanelBody,{title:(0,a.__)("System Information","wyvern-ai-styling"),initialOpen:!0,children:(0,v.jsx)(i.PanelRow,{children:(0,v.jsxs)("div",{className:"debug-info-grid",children:[(0,v.jsxs)("div",{className:"debug-info-item",children:[(0,v.jsx)("strong",{children:(0,a.__)("PHP Version:","wyvern-ai-styling")}),(0,v.jsx)("code",{children:e.system.php_version})]}),(0,v.jsxs)("div",{className:"debug-info-item",children:[(0,v.jsx)("strong",{children:(0,a.__)("WordPress Version:","wyvern-ai-styling")}),(0,v.jsx)("code",{children:e.system.wordpress_version})]}),(0,v.jsxs)("div",{className:"debug-info-item",children:[(0,v.jsx)("strong",{children:(0,a.__)("Plugin Version:","wyvern-ai-styling")}),(0,v.jsx)("code",{children:e.system.plugin_version})]}),(0,v.jsxs)("div",{className:"debug-info-item",children:[(0,v.jsx)("strong",{children:(0,a.__)("Memory Limit:","wyvern-ai-styling")}),(0,v.jsx)("code",{children:e.system.memory_limit})]}),(0,v.jsxs)("div",{className:"debug-info-item",children:[(0,v.jsx)("strong",{children:(0,a.__)("Max Execution Time:","wyvern-ai-styling")}),(0,v.jsxs)("code",{children:[e.system.max_execution_time,"s"]})]}),(0,v.jsxs)("div",{className:"debug-info-item",children:[(0,v.jsx)("strong",{children:(0,a.__)("WP_DEBUG:","wyvern-ai-styling")}),(0,v.jsx)("code",{children:e.system.wp_debug?"true":"false"})]}),(0,v.jsxs)("div",{className:"debug-info-item",children:[(0,v.jsx)("strong",{children:(0,a.__)("WP_DEBUG_LOG:","wyvern-ai-styling")}),(0,v.jsx)("code",{children:e.system.wp_debug_log?"true":"false"})]}),(0,v.jsxs)("div",{className:"debug-info-item",children:[(0,v.jsx)("strong",{children:(0,a.__)("Active Theme:","wyvern-ai-styling")}),(0,v.jsx)("code",{children:e.system.active_theme})]})]})})})}),"mcp"===s.name&&(0,v.jsx)(i.Panel,{children:(0,v.jsx)(i.PanelBody,{title:(0,a.__)("MCP Tools","wyvern-ai-styling")+` (${e.mcp.tools_count})`,initialOpen:!0,children:(0,v.jsx)(i.PanelRow,{children:(0,v.jsx)("div",{className:"debug-tools-list",children:0===e.mcp.tools.length?(0,v.jsx)(i.Notice,{status:"warning",isDismissible:!1,children:(0,a.__)("No MCP tools discovered. Check file permissions.","wyvern-ai-styling")}):(0,v.jsxs)("table",{className:"widefat striped",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:(0,a.__)("Tool Name","wyvern-ai-styling")}),(0,v.jsx)("th",{children:(0,a.__)("Description","wyvern-ai-styling")}),(0,v.jsx)("th",{children:(0,a.__)("Class","wyvern-ai-styling")})]})}),(0,v.jsx)("tbody",{children:e.mcp.tools.map((e,s)=>(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:(0,v.jsx)("code",{children:e.name})}),(0,v.jsx)("td",{children:e.description}),(0,v.jsx)("td",{children:(0,v.jsx)("code",{children:e.class})})]},s))})]})})})})}),"permissions"===s.name&&(0,v.jsx)(i.Panel,{children:(0,v.jsx)(i.PanelBody,{title:(0,a.__)("File Permissions","wyvern-ai-styling"),initialOpen:!0,children:(0,v.jsx)(i.PanelRow,{children:(0,v.jsx)("div",{className:"debug-permissions-list",children:0===Object.keys(e.permissions).length?(0,v.jsx)(i.Notice,{status:"info",isDismissible:!1,children:(0,a.__)("No permission issues detected.","wyvern-ai-styling")}):(0,v.jsxs)("table",{className:"widefat striped",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:(0,a.__)("File","wyvern-ai-styling")}),(0,v.jsx)("th",{children:(0,a.__)("Readable","wyvern-ai-styling")}),(0,v.jsx)("th",{children:(0,a.__)("Permissions","wyvern-ai-styling")})]})}),(0,v.jsx)("tbody",{children:Object.entries(e.permissions).map(([e,s],n)=>(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:(0,v.jsx)("code",{children:e})}),(0,v.jsx)("td",{children:(0,v.jsx)("span",{className:s.readable?"status-ok":"status-error",children:s.readable?"âœ“":"âœ—"})}),(0,v.jsx)("td",{children:(0,v.jsx)("code",{children:s.permissions})})]},n))})]})})})})}),"rest_api"===s.name&&(0,v.jsx)(i.Panel,{children:(0,v.jsx)(i.PanelBody,{title:(0,a.__)("REST API Routes","wyvern-ai-styling")+` (${e.rest_api.count})`,initialOpen:!0,children:(0,v.jsx)(i.PanelRow,{children:(0,v.jsx)("div",{className:"debug-routes-list",children:(0,v.jsx)("ul",{children:e.rest_api.routes.map((e,s)=>(0,v.jsx)("li",{children:(0,v.jsx)("code",{children:e})},s))})})})})}),"errors"===s.name&&(0,v.jsx)(i.Panel,{children:(0,v.jsx)(i.PanelBody,{title:(0,a.__)("Recent Errors","wyvern-ai-styling"),initialOpen:!0,children:(0,v.jsx)(i.PanelRow,{children:(0,v.jsx)("div",{className:"debug-errors-list",children:0===e.errors.length?(0,v.jsx)(i.Notice,{status:"success",isDismissible:!1,children:(0,a.__)("No recent errors found.","wyvern-ai-styling")}):(0,v.jsx)("div",{className:"error-log",children:e.errors.map((e,s)=>(0,v.jsx)("pre",{className:"error-line",children:e},s))})})})})}),"constants"===s.name&&(0,v.jsx)(i.Panel,{children:(0,v.jsx)(i.PanelBody,{title:(0,a.__)("WordPress Constants","wyvern-ai-styling"),initialOpen:!0,children:(0,v.jsx)(i.PanelRow,{children:(0,v.jsx)("div",{className:"debug-constants-list",children:(0,v.jsxs)("table",{className:"widefat striped",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:(0,a.__)("Constant","wyvern-ai-styling")}),(0,v.jsx)("th",{children:(0,a.__)("Value","wyvern-ai-styling")})]})}),(0,v.jsx)("tbody",{children:Object.entries(e.constants).map(([e,s],n)=>(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:(0,v.jsx)("code",{children:e})}),(0,v.jsx)("td",{children:(0,v.jsx)("code",{children:String(s)})})]},n))})]})})})})})]})})]})}function S(e){try{const s=new Date(e),n=(new Date).getTime()-s.getTime(),i=Math.floor(n/6e4),t=Math.floor(n/36e5),r=Math.floor(n/864e5);return i<1?(0,a.__)("Just now","wyvern-ai-styling"):i<60?`${i}m ago`:t<24?`${t}h ago`:r<7?`${r}d ago`:s.toLocaleDateString()}catch{return""}}function A({conversation:e,isActive:s,onSelect:n,onDelete:t}){const{id:r,title:l,message_count:o,updated_at:c,total_cost:d}=e;return(0,v.jsxs)("div",{className:"conversation-item "+(s?"conversation-active":""),onClick:()=>n(r),role:"button",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),n(r))},"aria-label":`${l} - ${o} messages`,"aria-current":s?"true":void 0,children:[(0,v.jsxs)("div",{className:"conversation-header",children:[(0,v.jsx)("h3",{className:"conversation-title",children:l}),(0,v.jsx)(i.Button,{icon:"trash",label:(0,a.__)("Delete conversation","wyvern-ai-styling"),onClick:e=>{e.stopPropagation();const s=(0,a.__)("Delete conversation","wyvern-ai-styling");confirm(`${s} "${l}"?`)&&t(r)},className:"conversation-delete",isSmall:!0})]}),(0,v.jsxs)("div",{className:"conversation-meta",children:[(0,v.jsxs)("span",{className:"conversation-messages",children:[o," ",1===o?(0,a.__)("message","wyvern-ai-styling"):(0,a.__)("messages","wyvern-ai-styling")]}),(0,v.jsx)("span",{className:"conversation-separator",children:"â€¢"}),(0,v.jsx)("span",{className:"conversation-time",children:S(c)})]}),void 0!==d&&d>0&&(0,v.jsxs)("div",{className:"conversation-cost",children:["$",d.toFixed(4)]})]})}function E({onConversationChange:e}){const{conversations:s,currentConversationId:n,error:i,deleteConversation:t,selectConversation:r}=g(),l=s=>{r(s),e?.(s)},o=async s=>{await t(s)&&e?.(n)};return(0,v.jsxs)("div",{className:"conversation-list",children:[(0,v.jsx)("div",{className:"conversation-list-header",children:(0,v.jsx)("h2",{children:(0,a.__)("Conversations","wyvern-ai-styling")})}),i&&(0,v.jsx)("div",{className:"conversation-error",role:"alert",children:i}),0===s.length?(0,v.jsx)("div",{className:"conversation-list-empty",children:(0,v.jsx)("p",{children:(0,a.__)("No conversations yet. Start chatting to create your first conversation!","wyvern-ai-styling")})}):(0,v.jsx)("div",{className:"conversation-list-items",role:"list",children:s.map(e=>(0,v.jsx)(A,{conversation:e,isActive:e.id===n,onSelect:l,onDelete:o},e.id))})]})}const I=[{id:"unused-media",label:(0,a.__)("Find Unused Media","wyvern-ai-styling"),command:"find unused media files",description:(0,a.__)("Identifies media files not used in any content","wyvern-ai-styling"),icon:"ðŸ–¼ï¸",requires_premium:!1},{id:"old-drafts",label:(0,a.__)("Delete Old Drafts","wyvern-ai-styling"),command:"delete draft posts older than 6 months",description:(0,a.__)("Removes old draft posts to clean up database","wyvern-ai-styling"),icon:"ðŸ—‘ï¸",requires_premium:!1},{id:"security-check",label:(0,a.__)("Security Check","wyvern-ai-styling"),command:"check site security settings",description:(0,a.__)("Reviews security configuration and provides recommendations","wyvern-ai-styling"),icon:"ðŸ”’",requires_premium:!0},{id:"optimize-images",label:(0,a.__)("Optimize Images","wyvern-ai-styling"),command:"find unoptimized images",description:(0,a.__)("Identifies images that need optimization","wyvern-ai-styling"),icon:"âš¡",requires_premium:!0}];function R({onExecute:e,disabled:n=!1,quickCommands:t=I}){const[r,l]=(0,s.useState)(""),[o,c]=(0,s.useState)(!1);return(0,v.jsxs)("div",{className:"admin-ai-command-input",children:[(0,v.jsxs)("form",{onSubmit:s=>{s.preventDefault(),r.trim()&&(e(r.trim()),l(""),c(!1))},children:[(0,v.jsxs)("div",{className:"command-input-wrapper",children:[(0,v.jsx)(i.TextControl,{label:(0,a.__)("Enter a command","wyvern-ai-styling"),hideLabelFromVision:!0,value:r,onChange:l,onFocus:()=>{c(!0)},onBlur:()=>{setTimeout(()=>{c(!1)},200)},placeholder:(0,a.__)('e.g., "Find unused media files" or "Delete old drafts"',"wyvern-ai-styling"),disabled:n,className:"command-input","aria-label":(0,a.__)("Admin AI command input","wyvern-ai-styling"),"aria-describedby":"command-input-help"}),(0,v.jsx)(i.Button,{type:"submit",variant:"primary",disabled:n||!r.trim(),"aria-label":(0,a.__)("Execute command","wyvern-ai-styling"),children:(0,a.__)("Execute","wyvern-ai-styling")})]}),(0,v.jsx)("div",{id:"command-input-help",className:"command-input-help",children:(0,a.__)("Describe what you want to do in natural language, or use a quick command below.","wyvern-ai-styling")})]}),(0,v.jsxs)("div",{className:"quick-commands",role:"group","aria-label":(0,a.__)("Quick commands","wyvern-ai-styling"),children:[(0,v.jsx)("h3",{children:(0,a.__)("Quick Commands","wyvern-ai-styling")}),(0,v.jsx)("div",{className:"quick-commands-grid",children:t.map(s=>(0,v.jsxs)("button",{type:"button",className:"quick-command-button",onClick:()=>(s=>{l(s.command),e(s.command),l("")})(s),disabled:n,"aria-label":s.description,children:[(0,v.jsx)("span",{className:"quick-command-icon","aria-hidden":"true",children:s.icon}),(0,v.jsx)("span",{className:"quick-command-label",children:s.label}),s.requires_premium&&(0,v.jsx)("span",{className:"premium-badge","aria-label":(0,a.__)("Premium feature","wyvern-ai-styling"),children:(0,a.__)("Premium","wyvern-ai-styling")})]},s.id))})]})]})}function T({result:e,onApplyRecommendation:s,onClose:n}){const t=e=>{switch(e){case"high":return"severity-high";case"medium":return"severity-medium";case"low":return"severity-low";default:return""}},r=e=>{switch(e){case"high":return(0,a.__)("High","wyvern-ai-styling");case"medium":return(0,a.__)("Medium","wyvern-ai-styling");case"low":return(0,a.__)("Low","wyvern-ai-styling");default:return e}};return(0,v.jsxs)("div",{className:"admin-ai-results",role:"region","aria-label":(0,a.__)("Command results","wyvern-ai-styling"),children:[(0,v.jsxs)("div",{className:"results-header",children:[(0,v.jsx)("h2",{children:(0,a.__)("Results","wyvern-ai-styling")}),(0,v.jsx)(i.Button,{variant:"tertiary",onClick:n,"aria-label":(0,a.__)("Close results","wyvern-ai-styling"),children:(0,a.__)("Clear","wyvern-ai-styling")})]}),(0,v.jsx)(i.Notice,{status:e.success?"success":"error",isDismissible:!1,children:e.message}),e.stats&&(0,v.jsxs)("div",{className:"results-stats",role:"group","aria-label":(0,a.__)("Operation statistics","wyvern-ai-styling"),children:[(0,v.jsx)("h3",{children:(0,a.__)("Statistics","wyvern-ai-styling")}),(0,v.jsxs)("div",{className:"stats-grid",children:[void 0!==e.stats.found&&(0,v.jsxs)("div",{className:"stat-item",children:[(0,v.jsx)("span",{className:"stat-label",children:(0,a.__)("Found:","wyvern-ai-styling")}),(0,v.jsx)("span",{className:"stat-value",children:e.stats.found})]}),void 0!==e.stats.processed&&(0,v.jsxs)("div",{className:"stat-item",children:[(0,v.jsx)("span",{className:"stat-label",children:(0,a.__)("Processed:","wyvern-ai-styling")}),(0,v.jsx)("span",{className:"stat-value",children:e.stats.processed})]}),void 0!==e.stats.deleted&&(0,v.jsxs)("div",{className:"stat-item",children:[(0,v.jsx)("span",{className:"stat-label",children:(0,a.__)("Deleted:","wyvern-ai-styling")}),(0,v.jsx)("span",{className:"stat-value",children:e.stats.deleted})]}),void 0!==e.stats.updated&&(0,v.jsxs)("div",{className:"stat-item",children:[(0,v.jsx)("span",{className:"stat-label",children:(0,a.__)("Updated:","wyvern-ai-styling")}),(0,v.jsx)("span",{className:"stat-value",children:e.stats.updated})]})]})]}),e.affected_items&&e.affected_items.length>0&&(0,v.jsxs)("div",{className:"results-affected-items",role:"group","aria-label":(0,a.__)("Affected items","wyvern-ai-styling"),children:[(0,v.jsx)("h3",{children:(0,a.__)("Affected Items","wyvern-ai-styling")}),(0,v.jsx)("ul",{className:"affected-items-list",children:e.affected_items.map(e=>(0,v.jsx)("li",{className:"affected-item",children:(0,v.jsxs)("div",{className:"item-content",children:[(0,v.jsx)("strong",{className:"item-title",children:e.title}),(0,v.jsxs)("span",{className:"item-meta",children:[e.type,e.status&&` - ${e.status}`]})]})},e.id))})]}),e.recommendations&&e.recommendations.length>0&&(0,v.jsxs)("div",{className:"results-recommendations",role:"group","aria-label":(0,a.__)("Recommendations","wyvern-ai-styling"),children:[(0,v.jsx)("h3",{children:(0,a.__)("Recommendations","wyvern-ai-styling")}),(0,v.jsx)("div",{className:"recommendations-list",children:e.recommendations.map(e=>(0,v.jsxs)("div",{className:"recommendation-card",children:[(0,v.jsxs)("div",{className:"recommendation-header",children:[(0,v.jsx)("h4",{children:e.title}),(0,v.jsx)("span",{className:`severity-badge ${t(e.severity)}`,"aria-label":`${(0,a.__)("Severity:","wyvern-ai-styling")} ${r(e.severity)}`,children:r(e.severity)})]}),(0,v.jsx)("p",{className:"recommendation-description",children:e.description}),e.auto_fixable&&s&&(0,v.jsx)(i.Button,{variant:"secondary",onClick:()=>(async e=>{s&&await s(e)})(e),className:"apply-fix-button","aria-label":`${(0,a.__)("Apply fix:","wyvern-ai-styling")} ${e.title}`,children:(0,a.__)("Apply Fix","wyvern-ai-styling")})]},e.id))})]})]})}function D({isOpen:e,title:s,message:n,affectedItems:t,isLoading:r=!1,onConfirm:l,onCancel:o}){return e?(0,v.jsx)(i.Modal,{title:s,onRequestClose:o,isDismissible:!r,className:"admin-ai-confirmation-modal",children:(0,v.jsxs)("div",{className:"confirmation-content",children:[(0,v.jsx)("p",{className:"confirmation-message",children:n}),t&&t.length>0&&(0,v.jsxs)("div",{className:"affected-items",children:[(0,v.jsx)("h3",{children:(0,a.__)("Items that will be affected:","wyvern-ai-styling")}),(0,v.jsx)("div",{className:"affected-items-list",children:t.length>10?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("ul",{"aria-label":(0,a.__)("First 10 affected items","wyvern-ai-styling"),children:t.slice(0,10).map(e=>(0,v.jsxs)("li",{children:[(0,v.jsx)("strong",{children:e.title}),(0,v.jsxs)("span",{className:"item-meta",children:[e.type,e.status&&` - ${e.status}`]})]},e.id))}),(0,v.jsx)("p",{className:"items-count",children:(0,a.sprintf)(
// translators: %d: number of additional items
// translators: %d: number of additional items
(0,a.__)("â€¦ and %d more items","wyvern-ai-styling"),t.length-10)})]}):(0,v.jsx)("ul",{"aria-label":(0,a.__)("Affected items","wyvern-ai-styling"),children:t.map(e=>(0,v.jsxs)("li",{children:[(0,v.jsx)("strong",{children:e.title}),(0,v.jsxs)("span",{className:"item-meta",children:[e.type,e.status&&` - ${e.status}`]})]},e.id))})})]}),(0,v.jsxs)("div",{className:"modal-buttons",children:[(0,v.jsx)(i.Button,{variant:"secondary",onClick:o,disabled:r,"aria-label":(0,a.__)("Cancel operation","wyvern-ai-styling"),children:(0,a.__)("Cancel","wyvern-ai-styling")}),(0,v.jsx)(i.Button,{variant:"primary",onClick:l,isBusy:r,disabled:r,"aria-label":(0,a.__)("Confirm and proceed with operation","wyvern-ai-styling"),children:r?(0,a.__)("Processingâ€¦","wyvern-ai-styling"):(0,a.__)("Confirm","wyvern-ai-styling")})]})]})}):null}function O({isPremium:e=!1}){const{isLoading:n,error:t,result:r,requiresConfirmation:l,confirmationMessage:o,executeCommand:c,applyRecommendation:d,clearResult:m,clearError:u}=function(){const[e,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(null),[t,r]=(0,s.useState)(null),[l,o]=(0,s.useState)(!1),[c,d]=(0,s.useState)(null),m=(0,s.useCallback)(async(e,s,a=!1)=>{n(!0),i(null),r(null),o(!1),d(null);try{const n={command:e,params:s,confirm:a},t=await y(n);if(t.success&&t.data){const e=t.data;return r(e),e.requires_confirmation&&!a&&(o(!0),d(e.confirmation_message||"Are you sure you want to proceed?")),e}const l=t.error?.message||"Command execution failed";return i(l),null}catch(e){const s=e instanceof Error?e.message:"Unknown error";return i(s),null}finally{n(!1)}},[]),u=(0,s.useCallback)(async e=>{if(!e.auto_fixable||!e.fix_command)return i("This recommendation cannot be automatically applied"),!1;const s=await m(e.fix_command,e.fix_params,!0);return s?.success||!1},[m]),h=(0,s.useCallback)(()=>{r(null),o(!1),d(null)},[]),g=(0,s.useCallback)(()=>{i(null)},[]);return{isLoading:e,error:a,result:t,requiresConfirmation:l,confirmationMessage:c,executeCommand:m,applyRecommendation:u,clearResult:h,clearError:g}}(),[h,g]=(0,s.useState)(null);return e?(0,v.jsxs)("div",{className:"admin-ai-panel",children:[(0,v.jsxs)("div",{className:"admin-ai-header",children:[(0,v.jsx)("h2",{children:(0,a.__)("Admin AI","wyvern-ai-styling")}),(0,v.jsx)("p",{className:"admin-ai-description",children:(0,a.__)("Execute WordPress administrative tasks using natural language commands.","wyvern-ai-styling")})]}),t&&(0,v.jsx)(i.Notice,{status:"error",isDismissible:!0,onRemove:u,children:t}),(0,v.jsxs)("div",{className:"admin-ai-content",children:[(0,v.jsx)(R,{onExecute:async e=>{g({command:e}),await c(e)},disabled:n}),n&&(0,v.jsxs)("div",{className:"admin-ai-loading",role:"status","aria-live":"polite",children:[(0,v.jsx)("div",{className:"loading-spinner","aria-hidden":"true"}),(0,v.jsx)("p",{children:(0,a.__)("Executing commandâ€¦","wyvern-ai-styling")})]}),r&&!l&&(0,v.jsx)(T,{result:r,onApplyRecommendation:d,onClose:m})]}),(0,v.jsx)(D,{isOpen:l,title:(0,a.__)("Confirm Action","wyvern-ai-styling"),message:o||(0,a.__)("Are you sure you want to proceed with this action?","wyvern-ai-styling"),affectedItems:r?.affected_items,isLoading:n,onConfirm:async()=>{h&&(await c(h.command,h.params,!0),g(null))},onCancel:()=>{g(null),m()}})]}):(0,v.jsx)("div",{className:"admin-ai-panel admin-ai-premium-gate",children:(0,v.jsxs)("div",{className:"premium-gate-content",children:[(0,v.jsx)("div",{className:"premium-icon","aria-hidden":"true",children:"ðŸš€"}),(0,v.jsx)("h2",{children:(0,a.__)("Admin AI - Premium Feature","wyvern-ai-styling")}),(0,v.jsx)("p",{children:(0,a.__)("Admin AI allows you to manage your WordPress site using natural language commands. Execute complex administrative tasks with simple instructions.","wyvern-ai-styling")}),(0,v.jsxs)("div",{className:"premium-features",children:[(0,v.jsx)("h3",{children:(0,a.__)("What you can do:","wyvern-ai-styling")}),(0,v.jsxs)("ul",{children:[(0,v.jsx)("li",{children:(0,a.__)("ðŸ” Find and manage unused media files","wyvern-ai-styling")}),(0,v.jsx)("li",{children:(0,a.__)("ðŸ—‘ï¸ Clean up old drafts and revisions","wyvern-ai-styling")}),(0,v.jsx)("li",{children:(0,a.__)("ðŸ”’ Check and improve security settings","wyvern-ai-styling")}),(0,v.jsx)("li",{children:(0,a.__)("âš¡ Optimize images and performance","wyvern-ai-styling")}),(0,v.jsx)("li",{children:(0,a.__)("ðŸ“Š Generate reports and analytics","wyvern-ai-styling")}),(0,v.jsx)("li",{children:(0,a.__)("ðŸ› ï¸ Automate routine maintenance tasks","wyvern-ai-styling")})]})]}),(0,v.jsx)("div",{className:"premium-cta",children:(0,v.jsx)("a",{href:"#upgrade",className:"button button-primary button-hero","aria-label":(0,a.__)("Upgrade to Premium to unlock Admin AI","wyvern-ai-styling"),children:(0,a.__)("Upgrade to Premium","wyvern-ai-styling")})})]})})}function F(){const e=new URLSearchParams(window.location.search).get("view");return"settings"===e||"debug"===e||"chat"===e||"admin-ai"===e?e:"chat"}function $(){var e;const{settings:s}=h(),{currentConversationId:t}=g(),[r,l]=(0,n.useState)(F),o=e=>{l(e),function(e){const s=new URLSearchParams(window.location.search);s.set("view",e);const n=`${window.location.pathname}?${s.toString()}`;window.history.pushState({view:e},"",n)}(e)};return(0,n.useEffect)(()=>{const e=e=>{e.state?.view?l(e.state.view):l(F())};return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},[]),(0,v.jsxs)("div",{className:"wyverncss-admin-console",children:[(0,v.jsxs)("header",{className:"wyverncss-header",children:[(0,v.jsxs)("div",{className:"header-left",children:[(0,v.jsx)("h1",{children:(0,a.__)("WyvernCSS AI Console","wyvern-ai-styling")}),(0,v.jsx)("span",{className:"header-subtitle",children:(0,a.__)("AI-powered WordPress management","wyvern-ai-styling")})]}),(0,v.jsx)("div",{className:"header-right",children:(0,v.jsxs)(i.ButtonGroup,{children:[(0,v.jsx)(i.Button,{variant:"chat"===r?"primary":"secondary",onClick:()=>o("chat"),"aria-pressed":"chat"===r,children:(0,a.__)("Chat","wyvern-ai-styling")}),(0,v.jsx)(i.Button,{variant:"admin-ai"===r?"primary":"secondary",onClick:()=>o("admin-ai"),"aria-pressed":"admin-ai"===r,children:(0,a.__)("Admin AI","wyvern-ai-styling")}),(0,v.jsx)(i.Button,{variant:"settings"===r?"primary":"secondary",onClick:()=>o("settings"),"aria-pressed":"settings"===r,children:(0,a.__)("Settings","wyvern-ai-styling")}),(0,v.jsx)(i.Button,{variant:"debug"===r?"primary":"secondary",onClick:()=>o("debug"),"aria-pressed":"debug"===r,children:(0,a.__)("Debug","wyvern-ai-styling")})]})})]}),(0,v.jsxs)("div",{className:"wyverncss-main",children:["chat"===r&&(0,v.jsx)("aside",{className:"wyverncss-sidebar",children:(0,v.jsx)(E,{})}),(0,v.jsxs)("main",{className:"wyverncss-content "+("chat"!==r?"wyverncss-content-full":""),role:"main",children:["settings"===r&&(0,v.jsx)(k,{}),"debug"===r&&(0,v.jsx)(P,{}),"admin-ai"===r&&(0,v.jsx)(O,{isPremium:!1}),"chat"===r&&(0,v.jsx)(f,{conversationId:t,showToolExecutions:null===(e=s?.preferences.show_tool_executions)||void 0===e||e})]})]})]})}function L(){const e=document.getElementById("wyverncss-admin-root");e&&(void 0!==window.wyvernPressAI?(0,s.render)((0,v.jsx)($,{}),e):e.innerHTML='\n\t\t\t<div class="notice notice-error">\n\t\t\t\t<p>WyvernCSS AI Console failed to load: WordPress data not found.</p>\n\t\t\t</div>\n\t\t')}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",L):L()})();