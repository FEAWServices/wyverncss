(()=>{"use strict";var e={795:e=>{e.exports=window.ReactDOM},827:(e,s,t)=>{var n=t(795);s.H=n.createRoot,n.hydrateRoot}},s={};const t=window.React;var n=function t(n){var i=s[n];if(void 0!==i)return i.exports;var r=s[n]={exports:{}};return e[n](r,r.exports,t),r.exports}(827);const i=window.wp.i18n,r=window.ReactJSXRuntime,a=({isOpen:e,onClick:s,theme:t})=>(0,r.jsx)("button",{type:"button",className:`wyverncss-chat-bubble wyverncss-chat-bubble--${t}`,onClick:s,"aria-label":e?(0,i.__)("Close chat","wyvern-ai-styling"):(0,i.__)("Open chat","wyvern-ai-styling"),"aria-expanded":e,children:e?(0,r.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,r.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}):(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,r.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}),o=({onSend:e,disabled:s,placeholder:n=(0,i.__)("Type your message…","wyvern-ai-styling"),theme:a})=>{const[o,c]=(0,t.useState)(""),l=(0,t.useCallback)(()=>{o.trim()&&!s&&(e(o.trim()),c(""))},[o,s,e]),d=(0,t.useCallback)(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),l())},[l]),h=0===o.trim().length;return(0,r.jsxs)("div",{className:`wyverncss-chat-input wyverncss-chat-input--${a}`,children:[(0,r.jsx)("label",{htmlFor:"wyverncss-message-input",className:"wyverncss-chat-input__label",children:(0,i.__)("Message","wyvern-ai-styling")}),(0,r.jsxs)("div",{className:"wyverncss-chat-input__wrapper",children:[(0,r.jsx)("textarea",{id:"wyverncss-message-input",className:"wyverncss-chat-input__field",value:o,onChange:e=>c(e.target.value),onKeyPress:d,placeholder:n,disabled:s,"aria-label":(0,i.__)("Message","wyvern-ai-styling"),rows:1}),(0,r.jsxs)("button",{type:"button",className:"wyverncss-chat-input__button",onClick:l,disabled:s||h,"aria-label":(0,i.__)("Send message","wyvern-ai-styling"),children:[(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),(0,r.jsx)("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),(0,r.jsx)("span",{className:"wyverncss-chat-input__button-text",children:(0,i.__)("Send","wyvern-ai-styling")})]})]})]})},c=({message:e,theme:s})=>{const t="user"===e.role,n=!0===e.error;return(0,r.jsxs)("div",{className:`wyverncss-message wyverncss-message--${e.role} wyverncss-message--${s}${n?" wyverncss-message--error":""}`,role:"article","aria-label":t?(0,i.__)("Your message","wyvern-ai-styling"):(0,i.__)("Assistant message","wyvern-ai-styling"),children:[(0,r.jsx)("div",{className:"wyverncss-message__avatar","aria-hidden":"true",children:t?(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,r.jsx)("circle",{cx:"12",cy:"7",r:"4"})]}):(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),(0,r.jsx)("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),(0,r.jsxs)("div",{className:"wyverncss-message__content",children:[(0,r.jsx)("p",{className:"wyverncss-message__text",children:e.content}),(0,r.jsx)("time",{className:"wyverncss-message__timestamp",dateTime:e.timestamp.toISOString(),children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},l=({theme:e})=>(0,r.jsxs)("div",{className:`wyverncss-typing-indicator wyverncss-typing-indicator--${e}`,role:"status","aria-live":"polite",children:[(0,r.jsx)("div",{className:"wyverncss-typing-indicator__avatar","aria-hidden":"true",children:(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),(0,r.jsx)("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),(0,r.jsxs)("div",{className:"wyverncss-typing-indicator__content",children:[(0,r.jsx)("span",{className:"wyverncss-typing-indicator__dot","aria-hidden":"true"}),(0,r.jsx)("span",{className:"wyverncss-typing-indicator__dot","aria-hidden":"true"}),(0,r.jsx)("span",{className:"wyverncss-typing-indicator__dot","aria-hidden":"true"}),(0,r.jsx)("span",{className:"wyverncss-sr-only",children:(0,i.__)("Assistant is typing","wyvern-ai-styling")})]})]}),d=({messages:e,isLoading:s,theme:n})=>{const a=(0,t.useRef)(null);return(0,t.useEffect)(()=>{a.current&&"function"==typeof a.current.scrollIntoView&&a.current.scrollIntoView({behavior:"smooth"})},[e,s]),(0,r.jsx)("div",{className:`wyverncss-message-list wyverncss-message-list--${n}`,children:0!==e.length||s?(0,r.jsxs)(r.Fragment,{children:[e.map(e=>(0,r.jsx)(c,{message:e,theme:n},e.id)),s&&(0,r.jsx)(l,{theme:n}),(0,r.jsx)("div",{ref:a,"aria-hidden":"true"})]}):(0,r.jsx)("div",{className:"wyverncss-message-list__empty",role:"status","aria-live":"polite",children:(0,r.jsx)("p",{children:(0,i.__)("Start a conversation by typing a message below.","wyvern-ai-styling")})})})},h=({botId:e,position:s,theme:n,width:c="400px",height:l="500px",placeholder:h=(0,i.__)("Type your message…","wyvern-ai-styling"),welcomeMessage:y})=>{const[w,g]=(0,t.useState)("inline"===s),[v,m]=(0,t.useState)([]),[u,x]=(0,t.useState)(!1),p=(0,t.useRef)(void 0);(0,t.useEffect)(()=>{if(y&&0===v.length){const e={id:`welcome-${Date.now()}`,role:"assistant",content:y,timestamp:new Date};m([e])}},[y,v.length]);const _=(0,t.useCallback)(()=>{g(e=>!e)},[]),j=(0,t.useCallback)(async s=>{const t={id:`user-${Date.now()}`,role:"user",content:s,timestamp:new Date};m(e=>[...e,t]),x(!0);try{const t={message:s,botId:e,conversationId:p.current},n=await fetch("/wp-json/wyverncss/v1/chat",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.wyverncssApiSettings?.nonce||""},body:JSON.stringify(t)});if(!n.ok)throw new Error((0,i.__)("HTTP error! Please try again.","wyvern-ai-styling"));const r=await n.json();if(!r.success)throw new Error(r.error||(0,i.__)("Failed to send message","wyvern-ai-styling"));r.data.conversationId&&(p.current=r.data.conversationId);const a={id:`bot-${Date.now()}`,role:"assistant",content:r.data.response,timestamp:new Date};m(e=>[...e,a])}catch(e){const s={id:`error-${Date.now()}`,role:"assistant",content:(0,i.__)("Sorry, there was an error processing your message. Please try again.","wyvern-ai-styling"),timestamp:new Date,error:!0};m(e=>[...e,s]),console.error("Chat error:",e)}finally{x(!1)}},[e]);return"floating"===s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a,{isOpen:w,onClick:_,theme:n}),w&&(0,r.jsxs)("div",{className:`wyverncss-chat-widget wyverncss-chat-widget--floating wyverncss-chat-widget--${n}`,style:{width:c,height:l},role:"region","aria-label":(0,i.__)("Chat widget","wyvern-ai-styling"),children:[(0,r.jsxs)("div",{className:"wyverncss-chat-widget__header",children:[(0,r.jsx)("h2",{className:"wyverncss-chat-widget__title",children:(0,i.__)("Chat","wyvern-ai-styling")}),(0,r.jsx)("button",{type:"button",className:"wyverncss-chat-widget__close",onClick:_,"aria-label":(0,i.__)("Close chat","wyvern-ai-styling"),children:(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,r.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,r.jsx)(d,{messages:v,isLoading:u,theme:n}),(0,r.jsx)(o,{onSend:j,disabled:u,placeholder:h,theme:n})]})]}):(0,r.jsxs)("div",{className:`wyverncss-chat-widget wyverncss-chat-widget--inline wyverncss-chat-widget--${n}`,style:{width:c,height:l},role:"region","aria-label":(0,i.__)("Chat widget","wyvern-ai-styling"),children:[(0,r.jsx)("div",{className:"wyverncss-chat-widget__header",children:(0,r.jsx)("h2",{className:"wyverncss-chat-widget__title",children:(0,i.__)("Chat","wyvern-ai-styling")})}),(0,r.jsx)(d,{messages:v,isLoading:u,theme:n}),(0,r.jsx)(o,{onSend:j,disabled:u,placeholder:h,theme:n})]})};function y(){document.querySelectorAll("[data-wyverncss-bot]").forEach(e=>{if(!(e instanceof HTMLElement))return;const s=e.getAttribute("data-wyverncss-bot"),t=e.getAttribute("data-position")||"floating",i=e.getAttribute("data-theme")||"light",a=e.getAttribute("data-width")||"400px",o=e.getAttribute("data-height")||"500px",c=e.getAttribute("data-placeholder")||void 0,l=e.getAttribute("data-welcome-message")||void 0;if(!s)return void console.error("WyvernCSS Chat Widget: Missing bot ID",e);const d={botId:s,position:t,theme:i,width:a,height:o,placeholder:c,welcomeMessage:l};try{(0,n.H)(e).render((0,r.jsx)(h,{...d}))}catch(s){console.error("WyvernCSS Chat Widget: Failed to initialize",s,e)}})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",y):y()})();