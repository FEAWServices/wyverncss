(()=>{"use strict";var e={795:e=>{e.exports=window.ReactDOM},827:(e,s,t)=>{var n=t(795);s.H=n.createRoot,n.hydrateRoot}},s={};const t=window.React;var n=function t(n){var r=s[n];if(void 0!==r)return r.exports;var a=s[n]={exports:{}};return e[n](a,a.exports,t),a.exports}(827);const r=window.wp.i18n,a=window.ReactJSXRuntime,i=({isOpen:e,onClick:s,theme:t})=>(0,a.jsx)("button",{type:"button",className:`wyverncss-chat-bubble wyverncss-chat-bubble--${t}`,onClick:s,"aria-label":e?(0,r.__)("Close chat","wyverncss"):(0,r.__)("Open chat","wyverncss"),"aria-expanded":e,children:e?(0,a.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,a.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,a.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}):(0,a.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,a.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}),o=({onSend:e,disabled:s,placeholder:n=(0,r.__)("Type your message…","wyverncss"),theme:i})=>{const[o,c]=(0,t.useState)(""),d=(0,t.useCallback)(()=>{o.trim()&&!s&&(e(o.trim()),c(""))},[o,s,e]),l=(0,t.useCallback)(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),d())},[d]),h=0===o.trim().length;return(0,a.jsxs)("div",{className:`wyverncss-chat-input wyverncss-chat-input--${i}`,children:[(0,a.jsx)("label",{htmlFor:"wyverncss-message-input",className:"wyverncss-chat-input__label",children:(0,r.__)("Message","wyverncss")}),(0,a.jsxs)("div",{className:"wyverncss-chat-input__wrapper",children:[(0,a.jsx)("textarea",{id:"wyverncss-message-input",className:"wyverncss-chat-input__field",value:o,onChange:e=>c(e.target.value),onKeyPress:l,placeholder:n,disabled:s,"aria-label":(0,r.__)("Message","wyverncss"),rows:1}),(0,a.jsxs)("button",{type:"button",className:"wyverncss-chat-input__button",onClick:d,disabled:s||h,"aria-label":(0,r.__)("Send message","wyverncss"),children:[(0,a.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,a.jsx)("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),(0,a.jsx)("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),(0,a.jsx)("span",{className:"wyverncss-chat-input__button-text",children:(0,r.__)("Send","wyverncss")})]})]})]})},c=({message:e,theme:s})=>{const t="user"===e.role,n=!0===e.error;return(0,a.jsxs)("div",{className:`wyverncss-message wyverncss-message--${e.role} wyverncss-message--${s}${n?" wyverncss-message--error":""}`,role:"article","aria-label":t?(0,r.__)("Your message","wyverncss"):(0,r.__)("Assistant message","wyverncss"),children:[(0,a.jsx)("div",{className:"wyverncss-message__avatar","aria-hidden":"true",children:t?(0,a.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,a.jsx)("circle",{cx:"12",cy:"7",r:"4"})]}):(0,a.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),(0,a.jsx)("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),(0,a.jsxs)("div",{className:"wyverncss-message__content",children:[(0,a.jsx)("p",{className:"wyverncss-message__text",children:e.content}),(0,a.jsx)("time",{className:"wyverncss-message__timestamp",dateTime:e.timestamp.toISOString(),children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},d=({theme:e})=>(0,a.jsxs)("div",{className:`wyverncss-typing-indicator wyverncss-typing-indicator--${e}`,role:"status","aria-live":"polite",children:[(0,a.jsx)("div",{className:"wyverncss-typing-indicator__avatar","aria-hidden":"true",children:(0,a.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),(0,a.jsx)("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),(0,a.jsxs)("div",{className:"wyverncss-typing-indicator__content",children:[(0,a.jsx)("span",{className:"wyverncss-typing-indicator__dot","aria-hidden":"true"}),(0,a.jsx)("span",{className:"wyverncss-typing-indicator__dot","aria-hidden":"true"}),(0,a.jsx)("span",{className:"wyverncss-typing-indicator__dot","aria-hidden":"true"}),(0,a.jsx)("span",{className:"wyverncss-sr-only",children:(0,r.__)("Assistant is typing","wyverncss")})]})]}),l=({messages:e,isLoading:s,theme:n})=>{const i=(0,t.useRef)(null);return(0,t.useEffect)(()=>{i.current&&"function"==typeof i.current.scrollIntoView&&i.current.scrollIntoView({behavior:"smooth"})},[e,s]),(0,a.jsx)("div",{className:`wyverncss-message-list wyverncss-message-list--${n}`,children:0!==e.length||s?(0,a.jsxs)(a.Fragment,{children:[e.map(e=>(0,a.jsx)(c,{message:e,theme:n},e.id)),s&&(0,a.jsx)(d,{theme:n}),(0,a.jsx)("div",{ref:i,"aria-hidden":"true"})]}):(0,a.jsx)("div",{className:"wyverncss-message-list__empty",role:"status","aria-live":"polite",children:(0,a.jsx)("p",{children:(0,r.__)("Start a conversation by typing a message below.","wyverncss")})})})},h=({botId:e,position:s,theme:n,width:c="400px",height:d="500px",placeholder:h=(0,r.__)("Type your message…","wyverncss"),welcomeMessage:w})=>{const[v,y]=(0,t.useState)("inline"===s),[g,m]=(0,t.useState)([]),[u,x]=(0,t.useState)(!1),p=(0,t.useRef)(void 0);(0,t.useEffect)(()=>{if(w&&0===g.length){const e={id:`welcome-${Date.now()}`,role:"assistant",content:w,timestamp:new Date};m([e])}},[w,g.length]);const _=(0,t.useCallback)(()=>{y(e=>!e)},[]),j=(0,t.useCallback)(async s=>{const t={id:`user-${Date.now()}`,role:"user",content:s,timestamp:new Date};m(e=>[...e,t]),x(!0);try{const t={message:s,botId:e,conversationId:p.current},n=await fetch("/wp-json/wyverncss/v1/chat",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.wyverncssApiSettings?.nonce||""},body:JSON.stringify(t)});if(!n.ok)throw new Error((0,r.__)("HTTP error! Please try again.","wyverncss"));const a=await n.json();if(!a.success)throw new Error(a.error||(0,r.__)("Failed to send message","wyverncss"));a.data.conversationId&&(p.current=a.data.conversationId);const i={id:`bot-${Date.now()}`,role:"assistant",content:a.data.response,timestamp:new Date};m(e=>[...e,i])}catch(e){const s={id:`error-${Date.now()}`,role:"assistant",content:(0,r.__)("Sorry, there was an error processing your message. Please try again.","wyverncss"),timestamp:new Date,error:!0};m(e=>[...e,s]),console.error("Chat error:",e)}finally{x(!1)}},[e]);return"floating"===s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i,{isOpen:v,onClick:_,theme:n}),v&&(0,a.jsxs)("div",{className:`wyverncss-chat-widget wyverncss-chat-widget--floating wyverncss-chat-widget--${n}`,style:{width:c,height:d},role:"region","aria-label":(0,r.__)("Chat widget","wyverncss"),children:[(0,a.jsxs)("div",{className:"wyverncss-chat-widget__header",children:[(0,a.jsx)("h2",{className:"wyverncss-chat-widget__title",children:(0,r.__)("Chat","wyverncss")}),(0,a.jsx)("button",{type:"button",className:"wyverncss-chat-widget__close",onClick:_,"aria-label":(0,r.__)("Close chat","wyverncss"),children:(0,a.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,a.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,a.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,a.jsx)(l,{messages:g,isLoading:u,theme:n}),(0,a.jsx)(o,{onSend:j,disabled:u,placeholder:h,theme:n})]})]}):(0,a.jsxs)("div",{className:`wyverncss-chat-widget wyverncss-chat-widget--inline wyverncss-chat-widget--${n}`,style:{width:c,height:d},role:"region","aria-label":(0,r.__)("Chat widget","wyverncss"),children:[(0,a.jsx)("div",{className:"wyverncss-chat-widget__header",children:(0,a.jsx)("h2",{className:"wyverncss-chat-widget__title",children:(0,r.__)("Chat","wyverncss")})}),(0,a.jsx)(l,{messages:g,isLoading:u,theme:n}),(0,a.jsx)(o,{onSend:j,disabled:u,placeholder:h,theme:n})]})};function w(){document.querySelectorAll("[data-wyverncss-bot]").forEach(e=>{if(!(e instanceof HTMLElement))return;const s=e.getAttribute("data-wyverncss-bot"),t=e.getAttribute("data-position")||"floating",r=e.getAttribute("data-theme")||"light",i=e.getAttribute("data-width")||"400px",o=e.getAttribute("data-height")||"500px",c=e.getAttribute("data-placeholder")||void 0,d=e.getAttribute("data-welcome-message")||void 0;if(!s)return void console.error("WyvernCSS Chat Widget: Missing bot ID",e);const l={botId:s,position:t,theme:r,width:i,height:o,placeholder:c,welcomeMessage:d};try{(0,n.H)(e).render((0,a.jsx)(h,{...l}))}catch(s){console.error("WyvernCSS Chat Widget: Failed to initialize",s,e)}})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",w):w()})();